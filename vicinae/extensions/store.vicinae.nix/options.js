"use strict";var M=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var A=(e,t)=>{for(var a in t)M(e,a,{get:t[a],enumerable:!0})},U=(e,t,a,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of v(t))!F.call(e,n)&&n!==a&&M(e,n,{get:()=>t[n],enumerable:!(o=T(t,n))||o.enumerable});return e};var z=e=>U(M({},"__esModule",{value:!0}),e);var R={};A(R,{default:()=>$});module.exports=z(R);var L=require("@vicinae/api");var b=require("@vicinae/api"),S=(0,b.getPreferenceValues)(),E={"User-Agent":"Mozilla/5.0 (X11; Linux x86_64; rv:138.0) Gecko/20100101 Firefox/138.0",Origin:"https://search.nixos.org/",Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${S.authToken}`};function f(e){return e?e.replace(/<[^>]*>/g,"").replace(/^\n+/,"").replace(/\n+$/,"").trim():""}async function P(e){let t={from:0,size:50,sort:[{_score:"desc",option_name:"desc"}],aggs:{all:{global:{},aggregations:{}}},query:{bool:{filter:[{term:{type:{value:"option",_name:"filter_options"}}}],must_not:[],must:[{dis_max:{tie_breaker:.7,queries:[{multi_match:{type:"cross_fields",query:e,analyzer:"whitespace",auto_generate_synonyms_phrase_query:!1,operator:"and",_name:`multi_match_${e}`,fields:["option_name^6","option_name.*^3.5999999999999996","option_description^1","option_description.*^0.6","flake_name^0.5","flake_name.*^0.3"]}},{wildcard:{option_name:{value:`*${e}*`,case_insensitive:!0}}}]}}]}},_source:["option_name","option_description","flake_name","option_type","option_default","option_example","option_source"]};try{let a=await fetch(S.searchUrl,{method:"POST",headers:E,body:JSON.stringify(t)});if(!a.ok)throw new Error(`Search request failed: ${a.status}`);let o=await a.json(),n=new Map;return o.hits.hits.forEach(l=>{let s=l._source,g=s.option_description||"No description available.",c=f(g),m=s.option_source?`https://github.com/NixOS/nixpkgs/blob/master/${s.option_source}`:void 0,_={name:s.option_name,description:c,flake:s.option_flake,type:s.option_type,default:s.option_default,example:s.option_example?f(s.option_example):void 0,option_source:s.option_source,sourceUrl:m,score:l._score},d=_.name;n.has(d)||n.set(d,_)}),Array.from(n.values()).sort((l,s)=>s.score-l.score)}catch(a){throw console.error("Failed to search Nix options:",a),a}}var i=require("@vicinae/api");var O=require("@vicinae/api"),u=require("@vicinae/api");async function h(e,t){try{await O.Clipboard.copy(e),(0,u.showToast)({style:u.Toast.Style.Success,title:"Copied",message:`${t} copied to clipboard`})}catch{(0,u.showToast)({style:u.Toast.Style.Failure,title:"Copy failed",message:`Failed to copy ${t.toLowerCase()}`})}}var r=require("react/jsx-runtime");function H({name:e,description:t,defaultValue:a,sourceUrl:o}){return(0,r.jsxs)(i.ActionPanel,{children:[o&&(0,r.jsx)(i.Action.OpenInBrowser,{title:"View Source Code",icon:i.Icon.Code,url:o,shortcut:{modifiers:["ctrl"],key:"s"}}),(0,r.jsx)(i.Action,{title:"Copy Option Name",icon:i.Icon.Clipboard,onAction:async()=>await h(e,"Option name"),shortcut:{modifiers:["ctrl"],key:"n"}}),(0,r.jsx)(i.Action,{title:"Copy Description",icon:i.Icon.Clipboard,onAction:async()=>await h(t,"Description"),shortcut:{modifiers:["ctrl"],key:"d"}}),a&&(0,r.jsx)(i.Action,{title:"Copy Default Value",icon:i.Icon.Clipboard,onAction:async()=>await h(a,"Default value"),shortcut:{modifiers:["ctrl"],key:"v"}})]})}function C({option:e}){return(0,r.jsx)(i.List.Item,{title:e.name,detail:(0,r.jsx)(i.List.Item.Detail,{markdown:`# ${e.name}

${f(e.description)}${e.example?`

**Example:**
\`\`\`
${f(e.example)}
\`\`\``:""}`,metadata:(()=>{let t=[],a=0;return e.type&&e.type.trim()&&(t.push((0,r.jsx)(i.List.Item.Detail.Metadata.Label,{title:"Type",text:e.type},"type")),a++),e.default&&e.default.trim()&&(a>0&&t.push((0,r.jsx)(i.List.Item.Detail.Metadata.Separator,{},`sep-${a}`)),t.push((0,r.jsx)(i.List.Item.Detail.Metadata.Label,{title:"Default",text:e.default},"default")),a++),e.flake&&e.flake.trim()&&(a>0&&t.push((0,r.jsx)(i.List.Item.Detail.Metadata.Separator,{},`sep-${a}`)),t.push((0,r.jsx)(i.List.Item.Detail.Metadata.Label,{title:"Flake",text:e.flake},"flake")),a++),(0,r.jsx)(i.List.Item.Detail.Metadata,{children:t})})()}),actions:(0,r.jsx)(H,{name:e.name,description:e.description,defaultValue:e.default,sourceUrl:e.option_source?`https://github.com/NixOS/nixpkgs/blob/master/${e.option_source}`:void 0})},e.name)}var x=require("@vicinae/api");var p=require("react"),y=require("@vicinae/api");function N(e,t="Search failed"){let[a,o]=(0,p.useState)([]),[n,l]=(0,p.useState)(!1),[s,g]=(0,p.useState)(""),c=(0,p.useRef)(null),m=(0,p.useCallback)(async d=>{if(!d.trim()){o([]);return}l(!0);try{let I=await e(d);o(I)}catch(I){console.error("Search failed:",I),(0,y.showToast)({style:y.Toast.Style.Failure,title:"Search failed",message:t}),o([])}finally{l(!1)}},[e,t]),_=(0,p.useCallback)(d=>{g(d),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{m(d),c.current=null},500)},[m]);return{items:a,isLoading:n,searchText:s,handleSearchTextChange:_}}var k=require("react/jsx-runtime");function w({searchFunction:e,errorMessage:t,placeholder:a,emptyIcon:o,emptyTitle:n,emptyDescription:l,renderItems:s}){let{items:g,isLoading:c,searchText:m,handleSearchTextChange:_}=N(e,t);return(0,k.jsxs)(x.List,{isLoading:c,onSearchTextChange:_,searchBarPlaceholder:a,isShowingDetail:!0,children:[s(g),!c&&m&&g.length===0&&(0,k.jsx)(x.List.EmptyView,{icon:o,title:`No results found for "${m}"`,description:"Try a different search term"}),!c&&!m&&(0,k.jsx)(x.List.EmptyView,{icon:o,title:n,description:l})]})}var D=require("react/jsx-runtime");function $(){return(0,D.jsx)(w,{searchFunction:P,errorMessage:"Failed to search Nix options. Please try again.",placeholder:"Search Nix options...",emptyIcon:L.Icon.Gear,emptyTitle:"Search Nix Options",emptyDescription:"Type in the search bar to find Nix options",renderItems:e=>e.map(t=>(0,D.jsx)(C,{option:t},t.name))})}
